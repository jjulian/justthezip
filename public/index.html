<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>justthezip.com</title>
<script type="text/javascript" src="http://code.google.com/apis/gears/gears_init.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="/javascripts/prototype.min.js"></script>
<script type="text/javascript" src="/javascripts/s2.min.js"></script>
<script type="text/javascript">

  function errorHandler(error) {
    console.log('error getting geolocation ('+error.message+') code: '+error.code);
    show("Sorry. I can't figure out where you are because an error occurred.");
  }

  function show(msg) {
    $("message").innerHTML = msg;
    $("message").setStyle({
      position:'absolute',
      bottom:0
    });
    $("message").morph('top:0', {duration: 4, transition: 'bounce'});
  }
  
  function initialize() {
    var geo = navigator.geolocation;
    if (!geo && (window.google && google.gears)) {
      geo = google.gears.factory.create('beta.geolocation');
    }
    if (geo) {
      geo.getCurrentPosition(function(position) {
        var myLatlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        console.log(myLatlng);
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode( {'latLng': myLatlng}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
              for (var x=0; x < results[0].address_components.length; x++) {
                console.log(results[0].address_components[x].types[0]+': '+results[0].address_components[x].short_name);
                if (results[0].address_components[x].types[0] === 'postal_code') {
                  show(results[0].address_components[x].short_name);
                  return;
                }
              }
              show("I'm not sure");
            } else {
              show("You don't seem to be near *anything*");
            }
          } else {
            show("Sorry. I can't figure out where you are.");
          }
        });
      }, errorHandler);
    } else {
      show("Sorry. I can't figure out where you are with this browser!");
    }
  }

</script>
</head>
<body onload="initialize();">
  <div id="container" style="width:100%; height:100%; font-family:sans-serif;">
    <div id="message" style="font-size:3em; text-align:center; width:100%; margin:10px;"></div>
    <div style="position:absolute; bottom:0;">justthezip.com by <a href="http://jonathanjulian.com/">Jonathan Julian</a></div>
  </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-9952121-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>

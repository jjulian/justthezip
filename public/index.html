<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>justthezip.com</title>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript">

  function errorHandler(error) {
    console.log('error getting geolocation ('+error.message+') code: '+error.code);
    show("Sorry. I can't figure out where you are because an error occurred.");
  }

  function show(msg) {
    document.getElementById("message").innerHTML = msg;
  }
  
  function initialize() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var myLatlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode( {'latLng': myLatlng}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
              for (var x=0; x < results[0].address_components.length; x++) {
                if (results[0].address_components[x].types[0] === 'postal_code') {
                  show(results[0].address_components[x].short_name);
                  return;
                }
              }
              show("I'm not sure");
            } else {
              show("You don't seem to be near *anything*");
            }
          } else {
            show("Sorry. I can't figure out where you are.");
          }
        });
      }, errorHandler);
    } else {
      show("Sorry. I can't figure out where you are with this browser!");
    }
  }

</script>
</head>
<body onload="initialize();">
  <div id="message" style="width:100%; height:100%; font-size:3em; text-align:center;"></div>
</body>
</html>
